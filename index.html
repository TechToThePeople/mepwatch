<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta content="initial-scale=1, shrink-to-fit=no, width=device-width" name="viewport">

    <!-- CSS -->
    <link href="dist/css/fonts.css" rel="stylesheet">
    <link href="dist/css/main.css" rel="stylesheet">
  </head>
  <body>
    <header>
      <div class="collapse bg-primary-light" id="navbarHeader">
        <div class="container">
          <div class="row">
            <div class="col-sm-8 col-md-7 py-4">
              <h4 class="">About</h4>
              <p class="">
              </p>
            </div>
            <div class="col-sm-4 offset-md-1 py-4">
              <h4 class="">Contact</h4>
              <ul class="list-unstyled">
                <li><a href="https://twitter.com/eucampaign" class="">Follow on Twitter</a></li>
              </ul>
            </div>
          </div>
        </div>
      </div>

      <div class="navbar navbar-dark bg-primary box-shadow">
        <div class="container d-flex justify-content-between">
          <a href="#" class="navbar-brand d-flex align-items-center">
            <i class="material-icons">blur_on</i>Project
          </a>
          <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarHeader" aria-controls="navbarHeader" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
        </div>
      </div>
    </header>

    <main role="main">

      <section class="jumbotron text-center">
        <div class="container">
          <h1 class="jumbotron-heading">Select the votes you want to analyse</h1>
          <p class="lead text-muted">Search bla</p>
          <p>
            <a href="#" class="btn btn-primary">Need it?</a>
            <a href="#" class="btn btn-secondary">Do not</a>
          </p>
        </div>
      </section>
     <div class="py-5 bg-light">
        <div class="container-fluid">

          <div class="row">
            <div class="col-md-4">
              <div class="card mb-4 box-shadow">
                <div class="card-body">
                  <h5 class="card-title text-muted text-right">Card title</h5>
                  <p class="card-text">This is a wider card with supporting text below as a natural lead-in to additional content. This content is a little bit longer.</p>
                  <div class="d-flex justify-content-between align-items-center">
                    <div class="btn-group">
                      <button type="button" class="btn btn-sm btn-outline-secondary">View</button>
                      <button type="button" class="btn btn-sm btn-outline-secondary">Edit</button>
                    </div>
                    <small class="text-muted">Extra</small>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

          <div class="row">
            <div class="col-md-12">
            <table class="table table-stripped">
              <thead>
                <tr>
                  <th>Date</th>
                  <th>Name</th>
                </tr>
              </thead>
              <tbody>
              </tbody>
            </table>
            </div>
          </div>
    </main>

    <footer class="text-muted">
      <div class="container">
        <p class="float-right">
          <a href="#">Back to top</a>
        </p>
      </div>
    </footer>

    <!-- Optional JavaScript -->
    <script src="dist/js/main.js"></script> 
    <script src="dist/js/dcbundle.js"></script>
<script>
  'use strict';
  var ndx=null;
  var graphs={};
  var dateFormat = d3.timeParse("%Y-%m-%d %H:%M:%S");
  d3.csv('data/8term.csv',function(d){
    console.log(d);
    d.created=dateFormat(d.created);
    d.modified=dateFormat(d.modified);
    try {
      d.tweet=JSON.parse(d.tweet);
    } catch (e) {}
    return d;
  })
  .then(function(d){
    console.log(d[0]);
    ndx = crossfilter(d);
    draw();
  });
   
  function draw(){
    console.log("AAA");
    graphs.table=drawTable('table .table');
    dc.renderAll();
  }

  function drawTable(dom){
    var dim = ndx.dimension(function(d) {
      return 1
    });
    var graph = dc.dataTable(dom)
      .dimension(dim)
      .size(1000)
      .sortBy(function(d) {
        return d.since;
      })
      .order (d3.descending)
      .showGroups(false)
      .group(function(d) {
        return null;
      })
      .columns([
        function(d) {
          //return "<a target='_blank' href='http://www.europarl.europa.eu/meps/en/" + d.epid + "/_home.html'>" + d.first_name + " " + d.last_name + "</a>";
          return d.created;
        },function(d){
          return d.user_name;
        },function(d){
          return d.content;
        }
    ]);
    console.log("BBB");
    return graph;
  }

</script>
  </body>
</html>
